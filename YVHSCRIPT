local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local StarterGui = game:GetService("StarterGui")
local VirtualUser = game:GetService("VirtualUser")
local VirtualInputManager = game:GetService("VirtualInputManager")
local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

local Blacklist = {
    "toile_tananasnasdas", "deerxsx", "noonieloafer", "jzzf", "AGElSPOLlS", "2fartedd", 
    "fancycmoneyfreshman0", "Matute44523", "Agust3K", "casyyalo3", 
    "qwertyuiopasdfghjklzxcvbnmdyhdthgduhgdyhgcgi", "YOUSMELLHORRID", "CptDev_5", 
    "sstymkiwi", "msgYamada", "arcadius0322", "nervepaws", "sssommnn12", "Frela1238", 
    "cloneRemover", "Vanixic1", "bucketofmice", "Landohns", "0YDEU", "PizzaGovan", 
    "Chumbeg", "6492Z", "cnotma", "iwannagohome673", "arppi213456", "ZixorHD", 
    "SparkTehDog", "y0utrynot", "EnkJuice", "Judelinc", "Fruitbytheleg"
}

local function CheckBlacklist(player)
    if table.find(Blacklist, player.Name) then
        LocalPlayer:Kick("Security Trigger: Blacklisted player " .. player.Name .. " detected.")
    end
end

for _, p in pairs(Players:GetPlayers()) do CheckBlacklist(p) end
Players.PlayerAdded:Connect(CheckBlacklist)

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "YvH_Complete_Dark"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local ToggleFrame = Instance.new("Frame")
ToggleFrame.Name = "ToggleFrame"
ToggleFrame.Parent = ScreenGui
ToggleFrame.BackgroundColor3 = Color3.fromRGB(12, 12, 12)
ToggleFrame.Position = UDim2.new(0.1, 0, 0.1, 0)
ToggleFrame.Size = UDim2.new(0, 60, 0, 60)
ToggleFrame.BorderSizePixel = 0
ToggleFrame.Active = true

local ToggleCorner = Instance.new("UICorner")
ToggleCorner.CornerRadius = UDim.new(0, 12)
ToggleCorner.Parent = ToggleFrame

local ToggleStroke = Instance.new("UIStroke")
ToggleStroke.Parent = ToggleFrame
ToggleStroke.Color = Color3.fromRGB(45, 45, 50)
ToggleStroke.Thickness = 2

local QuestionLabel = Instance.new("TextLabel")
QuestionLabel.Parent = ToggleFrame
QuestionLabel.BackgroundTransparency = 1
QuestionLabel.AnchorPoint = Vector2.new(0.5, 0.5)
QuestionLabel.Position = UDim2.new(0.5, 0, 0.5, 0)
QuestionLabel.Size = UDim2.new(0.8, 0, 0.8, 0)
QuestionLabel.Font = Enum.Font.GothamBold
QuestionLabel.Text = "?"
QuestionLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
QuestionLabel.TextSize = 36

local ToggleBtn = Instance.new("TextButton")
ToggleBtn.Parent = ToggleFrame
ToggleBtn.BackgroundTransparency = 1
ToggleBtn.Size = UDim2.new(1, 0, 1, 0)
ToggleBtn.Text = ""

local rotationTweenInfo = TweenInfo.new(3, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1)
local rotateTween = TweenService:Create(QuestionLabel, rotationTweenInfo, {Rotation = 360})
rotateTween:Play()

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 12)
MainFrame.Position = UDim2.new(0.5, -130, 0.5, -240)
MainFrame.Size = UDim2.new(0, 260, 0, 480)
MainFrame.BorderSizePixel = 0
MainFrame.Visible = false
MainFrame.ClipsDescendants = true

local MainStroke = Instance.new("UIStroke")
MainStroke.Parent = MainFrame
MainStroke.Color = Color3.fromRGB(40, 40, 45)
MainStroke.Thickness = 1.5

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 10)
MainCorner.Parent = MainFrame

local TopBar = Instance.new("Frame")
TopBar.Parent = MainFrame
TopBar.BackgroundColor3 = Color3.fromRGB(15, 15, 18)
TopBar.Size = UDim2.new(1, 0, 0, 40)
TopBar.BorderSizePixel = 0
Instance.new("UICorner", TopBar).CornerRadius = UDim.new(0, 10)

local Title = Instance.new("TextLabel")
Title.Parent = TopBar
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0, 15, 0, 0)
Title.Size = UDim2.new(0.7, 0, 1, 0)
Title.Font = Enum.Font.GothamBold
Title.Text = "YvH DARK v2"
Title.TextColor3 = Color3.fromRGB(220, 220, 220)
Title.TextSize = 16
Title.TextXAlignment = Enum.TextXAlignment.Left

local SearchBar = Instance.new("TextBox")
SearchBar.Parent = MainFrame
SearchBar.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
SearchBar.Position = UDim2.new(0, 10, 0, 45)
SearchBar.Size = UDim2.new(1, -20, 0, 30)
SearchBar.Font = Enum.Font.GothamMedium
SearchBar.PlaceholderText = "Search..."
SearchBar.Text = ""
SearchBar.TextColor3 = Color3.fromRGB(255, 255, 255)
SearchBar.TextSize = 14
SearchBar.PlaceholderColor3 = Color3.fromRGB(100, 100, 110)
Instance.new("UICorner", SearchBar).CornerRadius = UDim.new(0, 8)

local ContentFrame = Instance.new("ScrollingFrame")
ContentFrame.Parent = MainFrame
ContentFrame.BackgroundTransparency = 1
ContentFrame.Position = UDim2.new(0, 10, 0, 85)
ContentFrame.Size = UDim2.new(1, -20, 1, -95)
ContentFrame.ScrollBarThickness = 2
ContentFrame.BorderSizePixel = 0
ContentFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
ContentFrame.CanvasSize = UDim2.new(0, 0, 0, 0)

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Parent = ContentFrame
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Padding = UDim.new(0, 8)
UIListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

ToggleBtn.MouseButton1Click:Connect(function()
    MainFrame.Visible = not MainFrame.Visible
end)

local function makeDraggable(frame)
    local dragging, dragInput, dragStart, startPos
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then dragging = false end
            end)
        end
    end)
    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            TweenService:Create(frame, TweenInfo.new(0.05), {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)}):Play()
        end
    end)
end
makeDraggable(MainFrame)
makeDraggable(ToggleFrame)

local function createLabel(text, order)
    local lbl = Instance.new("TextLabel")
    lbl.Parent = ContentFrame
    lbl.BackgroundTransparency = 1
    lbl.Size = UDim2.new(1, 0, 0, 25)
    lbl.Font = Enum.Font.GothamBlack
    lbl.Text = text
    lbl.TextColor3 = Color3.fromRGB(150, 150, 150)
    lbl.TextSize = 12
    lbl.LayoutOrder = order
    return lbl
end

local function createButton(text)
    local btn = Instance.new("TextButton")
    local corner = Instance.new("UICorner")
    btn.Name = text
    btn.BackgroundColor3 = Color3.fromRGB(25, 25, 28)
    btn.Font = Enum.Font.GothamSemibold
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(220, 220, 220)
    btn.TextSize = 11
    btn.AutoButtonColor = true
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = btn
    local stroke = Instance.new("UIStroke")
    stroke.Parent = btn
    stroke.Color = Color3.fromRGB(50, 50, 55)
    stroke.Thickness = 1
    return btn
end

local function addRow(buttons, order)
    local row = Instance.new("Frame")
    row.Parent = ContentFrame
    row.BackgroundTransparency = 1
    row.Size = UDim2.new(1, 0, 0, 30)
    row.LayoutOrder = order
    local layout = Instance.new("UIListLayout")
    layout.Parent = row
    layout.FillDirection = Enum.FillDirection.Horizontal
    layout.Padding = UDim.new(0, 5)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    for _, btn in pairs(buttons) do
        btn.Parent = row
        if #buttons == 1 then btn.Size = UDim2.new(1, 0, 1, 0)
        else btn.Size = UDim2.new(0.5, -3, 1, 0) end
    end
end

local FarmButton = createButton("Farm Coins")
local FarmWinsButton = createButton("Auto Farm Wins")
local TPToHomerButton = createButton("TP Homer")
local ScanNoItemButton = createButton("Scan No Items")
local SpectateHomerButton = createButton("Spectate Homer")
local KillAllButton = createButton("Kill All")
local AnnoyButton = createButton("Annoy Server")
local PizzaSpamButton = createButton("Pizza Spam")
local TacoSpamButton = createButton("Taco Spam")
local RitualButton = createButton("Homer Ritual")
local UpsideDownButton = createButton("Upside Down")
local InfJumpButton = createButton("Inf Jump")
local ServerHopButton = createButton("Server Hop")
local RejoinButton = createButton("Rejoin")
local PlatformButton = createButton("Platform")
local WallhopButton = createButton("Wallhop")
local ESPButton = createButton("ESP")
local DotESPButton = createButton("Dot ESP")
local FullbrightButton = createButton("Fullbright")
local PlayerSpectateButton = createButton("Spectate Player")
local TPToolButton = createButton("TP Tool")
local SpawnButton = createButton("Goto Spawn")
local MapButton = createButton("Goto Map")
local FPSBoostButton = createButton("FPS Boost")
local BlueBoxButton = createButton("Blue Box")

createLabel("FARMING", 1)
addRow({FarmButton, FarmWinsButton}, 2)

createLabel("TARGETING & HOMER", 10)
addRow({TPToHomerButton, ScanNoItemButton}, 11)
addRow({SpectateHomerButton, RitualButton}, 12)

createLabel("TROLLING", 20)
addRow({KillAllButton}, 21)
addRow({AnnoyButton, PizzaSpamButton}, 22)
addRow({TacoSpamButton, UpsideDownButton}, 23)

createLabel("MOVEMENT & SERVER", 30)
addRow({InfJumpButton, ServerHopButton}, 31)
addRow({RejoinButton, PlatformButton}, 32)
addRow({WallhopButton}, 33)

createLabel("VISUALS", 40)
addRow({ESPButton, DotESPButton}, 41)
addRow({FullbrightButton, PlayerSpectateButton}, 42)

createLabel("MISC", 50)
addRow({TPToolButton, SpawnButton}, 51)
addRow({MapButton, FPSBoostButton}, 52)
addRow({BlueBoxButton}, 53)

local SpectateFrame = Instance.new("Frame")
SpectateFrame.Name = "SpectateFrame"
SpectateFrame.Parent = ScreenGui
SpectateFrame.BackgroundColor3 = Color3.fromRGB(12, 12, 14)
SpectateFrame.Position = UDim2.new(0.5, -110, 0.85, 0)
SpectateFrame.Size = UDim2.new(0, 220, 0, 90)
SpectateFrame.Visible = false
SpectateFrame.Active = true
Instance.new("UICorner", SpectateFrame).CornerRadius = UDim.new(0, 10)
Instance.new("UIStroke", SpectateFrame).Color = Color3.fromRGB(50, 50, 60)

local SpecName = Instance.new("TextLabel")
SpecName.Parent = SpectateFrame
SpecName.BackgroundTransparency = 1
SpecName.Position = UDim2.new(0, 0, 0, 8)
SpecName.Size = UDim2.new(1, 0, 0, 20)
SpecName.Font = Enum.Font.GothamBold
SpecName.Text = "Player Name"
SpecName.TextColor3 = Color3.fromRGB(255, 255, 255)
SpecName.TextSize = 14

local SpecPrev = Instance.new("TextButton")
SpecPrev.Parent = SpectateFrame
SpecPrev.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
SpecPrev.Position = UDim2.new(0, 10, 0, 40)
SpecPrev.Size = UDim2.new(0, 35, 0, 35)
SpecPrev.Font = Enum.Font.GothamBold
SpecPrev.Text = "<"
SpecPrev.TextColor3 = Color3.fromRGB(255, 255, 255)
SpecPrev.TextSize = 18
Instance.new("UICorner", SpecPrev).CornerRadius = UDim.new(0, 8)

local SpecNext = Instance.new("TextButton")
SpecNext.Parent = SpectateFrame
SpecNext.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
SpecNext.Position = UDim2.new(1, -45, 0, 40)
SpecNext.Size = UDim2.new(0, 35, 0, 35)
SpecNext.Font = Enum.Font.GothamBold
SpecNext.Text = ">"
SpecNext.TextColor3 = Color3.fromRGB(255, 255, 255)
SpecNext.TextSize = 18
Instance.new("UICorner", SpecNext).CornerRadius = UDim.new(0, 8)

local SpecExit = Instance.new("TextButton")
SpecExit.Parent = SpectateFrame
SpecExit.BackgroundColor3 = Color3.fromRGB(180, 40, 40)
SpecExit.Position = UDim2.new(1, -22, 0, -8)
SpecExit.Size = UDim2.new(0, 24, 0, 24)
SpecExit.Font = Enum.Font.GothamBold
SpecExit.Text = "X"
SpecExit.TextColor3 = Color3.fromRGB(255, 255, 255)
SpecExit.TextSize = 12
Instance.new("UICorner", SpecExit).CornerRadius = UDim.new(1, 0)
makeDraggable(SpectateFrame)

SearchBar:GetPropertyChangedSignal("Text"):Connect(function()
    local text = SearchBar.Text:lower()
    for _, desc in pairs(ContentFrame:GetDescendants()) do
        if desc:IsA("TextButton") then
            if desc.Name:lower():find(text) then
                if desc.Parent and desc.Parent:IsA("Frame") then desc.Parent.Visible = true end
            else
                if desc.Parent and desc.Parent:IsA("Frame") then desc.Parent.Visible = false end
            end
        end
    end
end)

local farming = false
local farmWins = false
local killAllActive = false
local annoyServer = false
local infJumpEnabled = false
local spectatingHomer = false
local ritualActive = false
local ritualStartTime = 0
local platformActive = false
local myPlatform = nil
local espEnabled = false
local dotEspEnabled = false
local pizzaSpamActive = false
local fullbright = false
local tpToolActive = false
local tpToolInstance = nil
local upsideDownActive = false
local tacoSpamActive = false
local annoyPlatform = nil
local nextAnnoyTime = 0
local currentAnnoyTarget = nil
local spectateIndex = 1
local spectatingPlayers = {}
local currentSpectateTarget = nil

local homerCoords = Vector3.new(56.80, 141.50, -60.41)
local farmTarget = Vector3.new(-33.01, 210.90, 110.05)

local function toggleColor(btn, active)
    if active then
        TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(180, 40, 40)}):Play()
    else
        TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(25, 25, 28)}):Play()
    end
end

InfJumpButton.MouseButton1Click:Connect(function()
    infJumpEnabled = not infJumpEnabled
    toggleColor(InfJumpButton, infJumpEnabled)
    InfJumpButton.Text = infJumpEnabled and "Inf Jump: ON" or "Inf Jump"
end)

UserInputService.JumpRequest:Connect(function()
    if infJumpEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
        LocalPlayer.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
    end
end)

RejoinButton.MouseButton1Click:Connect(function()
    TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, LocalPlayer)
end)

ServerHopButton.MouseButton1Click:Connect(function()
    ServerHopButton.Text = "Hopping..."
    local servers = HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?sortOrder=Asc&limit=100"))
    for _, server in pairs(servers.data) do
        if server.playing < server.maxPlayers and server.id ~= game.JobId then
            TeleportService:TeleportToPlaceInstance(game.PlaceId, server.id, LocalPlayer)
            break
        end
    end
end)

ScanNoItemButton.MouseButton1Click:Connect(function()
    local targetFound = nil
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
            local hasPizza = false
            local hasTaco = false
            if p.Character:FindFirstChild("Pizza") then hasPizza = true end
            if p.Character:FindFirstChild("Taco") then hasTaco = true end
            if p.Backpack:FindFirstChild("Pizza") then hasPizza = true end
            if p.Backpack:FindFirstChild("Taco") then hasTaco = true end
            if not hasPizza and not hasTaco then
                targetFound = p
                break
            end
        end
    end
    if targetFound and LocalPlayer.Character then
        ScanNoItemButton.Text = "Found: " .. targetFound.Name
        LocalPlayer.Character.HumanoidRootPart.CFrame = targetFound.Character.HumanoidRootPart.CFrame
        task.wait(2)
        ScanNoItemButton.Text = "Scan No Items"
    else
        ScanNoItemButton.Text = "None Found"
        task.wait(1)
        ScanNoItemButton.Text = "Scan No Items"
    end
end)

TPToHomerButton.MouseButton1Click:Connect(function()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(homerCoords)
    end
end)

SpectateHomerButton.MouseButton1Click:Connect(function()
    spectatingHomer = not spectatingHomer
    toggleColor(SpectateHomerButton, spectatingHomer)
    if spectatingHomer then
        SpectateHomerButton.Text = "Watching Homer..."
        local camPart = Instance.new("Part")
        camPart.Name = "HomerCam"
        camPart.Anchored = true
        camPart.Transparency = 1
        camPart.CanCollide = false
        camPart.Position = homerCoords
        camPart.Parent = workspace
        Camera.CameraSubject = camPart
    else
        SpectateHomerButton.Text = "Spectate Homer"
        if workspace:FindFirstChild("HomerCam") then workspace.HomerCam:Destroy() end
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            Camera.CameraSubject = LocalPlayer.Character.Humanoid
        end
    end
end)

FarmButton.MouseButton1Click:Connect(function()
    farming = not farming
    toggleColor(FarmButton, farming)
end)

FarmWinsButton.MouseButton1Click:Connect(function()
    farmWins = not farmWins
    toggleColor(FarmWinsButton, farmWins)
    task.spawn(function()
        while farmWins do
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("HumanoidRootPart") then
                local p = char:FindFirstChild("Pizza") or LocalPlayer.Backpack:FindFirstChild("Pizza")
                local t = char:FindFirstChild("Taco") or LocalPlayer.Backpack:FindFirstChild("Taco")
                if not p or not t then
                    for _, pl in pairs(Players:GetPlayers()) do
                        if not farmWins then break end
                        if pl ~= LocalPlayer and pl.Character and pl.Character:FindFirstChild("HumanoidRootPart") then
                            char.HumanoidRootPart.CFrame = pl.Character.HumanoidRootPart.CFrame
                            task.wait(0.2)
                        end
                    end
                else
                    char.HumanoidRootPart.CFrame = CFrame.new(homerCoords)
                end
            end
            task.wait(8)
        end
    end)
end)

KillAllButton.MouseButton1Click:Connect(function()
    killAllActive = not killAllActive
    toggleColor(KillAllButton, killAllActive)
    task.spawn(function()
        while killAllActive do
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                 for _, plr in pairs(Players:GetPlayers()) do
                    if not killAllActive then break end
                    if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("Humanoid") and plr.Character.Humanoid.Health > 0 and plr.Character:FindFirstChild("HumanoidRootPart") then
                        LocalPlayer.Character.HumanoidRootPart.CFrame = plr.Character.HumanoidRootPart.CFrame
                        local tool = LocalPlayer.Character:FindFirstChildOfClass("Tool") or LocalPlayer.Backpack:FindFirstChildOfClass("Tool")
                        if tool then tool.Parent = LocalPlayer.Character tool:Activate() end
                        task.wait(0.15)
                    end
                end
            end
            task.wait()
        end
    end)
end)

AnnoyButton.MouseButton1Click:Connect(function()
    annoyServer = not annoyServer
    toggleColor(AnnoyButton, annoyServer)
    if not annoyServer then
        if annoyPlatform then annoyPlatform:Destroy() annoyPlatform = nil end
        currentAnnoyTarget = nil
    end
end)

PizzaSpamButton.MouseButton1Click:Connect(function()
    pizzaSpamActive = not pizzaSpamActive
    toggleColor(PizzaSpamButton, pizzaSpamActive)
end)

TacoSpamButton.MouseButton1Click:Connect(function()
    tacoSpamActive = not tacoSpamActive
    toggleColor(TacoSpamButton, tacoSpamActive)
end)

RitualButton.MouseButton1Click:Connect(function()
    if ritualActive then return end
    ritualActive = true
    ritualStartTime = tick()
    RitualButton.Text = "ASCENDING..."
    TweenService:Create(RitualButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(160, 40, 160)}):Play()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.Anchored = true
    end
end)

PlatformButton.MouseButton1Click:Connect(function()
    platformActive = not platformActive
    toggleColor(PlatformButton, platformActive)
    if not platformActive and myPlatform then myPlatform:Destroy() myPlatform = nil end
end)

local function updateBoxESP(model, color)
    if not model or not model.Parent then return end
    local head = model:FindFirstChild("Head")
    if not head then return end
    local bb = head:FindFirstChild("YVH_BoxESP")
    if not bb then
        bb = Instance.new("BillboardGui")
        bb.Name = "YVH_BoxESP"
        bb.Adornee = head
        bb.Size = UDim2.new(4.5, 0, 6, 0)
        bb.AlwaysOnTop = true
        bb.Parent = head
        local frame = Instance.new("Frame")
        frame.Size = UDim2.new(1, 0, 1, 0)
        frame.BackgroundTransparency = 1
        frame.Parent = bb
        local stroke = Instance.new("UIStroke")
        stroke.Thickness = 2
        stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
        stroke.Parent = frame
    end
    if bb and bb:FindFirstChild("Frame") and bb.Frame:FindFirstChild("UIStroke") then
        bb.Frame.UIStroke.Color = color
    end
end

local function updateDotESP(model, color)
    if not model or not model.Parent then return end
    local head = model:FindFirstChild("Head")
    if not head then return end
    local bb = head:FindFirstChild("YVH_DotESP")
    if not bb then
        bb = Instance.new("BillboardGui")
        bb.Name = "YVH_DotESP"
        bb.Adornee = head
        bb.Size = UDim2.new(0, 15, 0, 15)
        bb.AlwaysOnTop = true
        bb.Parent = head
        local dot = Instance.new("Frame")
        dot.Size = UDim2.new(1, 0, 1, 0)
        dot.BackgroundColor3 = color
        dot.BorderSizePixel = 0
        dot.Parent = bb
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(1, 0)
        corner.Parent = dot
    end
    if bb and bb:FindFirstChild("Frame") then
        bb.Frame.BackgroundColor3 = color
    end
end

local function checkItems(plr)
    local hasPizza = false
    local hasTaco = false
    if plr.Character then
        if plr.Character:FindFirstChild("Pizza") then hasPizza = true end
        if plr.Character:FindFirstChild("Taco") then hasTaco = true end
    end
    if plr.Backpack then
        if plr.Backpack:FindFirstChild("Pizza") then hasPizza = true end
        if plr.Backpack:FindFirstChild("Taco") then hasTaco = true end
    end
    return hasPizza and hasTaco
end

local function clearESP()
    for _, plr in pairs(Players:GetPlayers()) do
        if plr.Character then
            local head = plr.Character:FindFirstChild("Head")
            if head then
                if head:FindFirstChild("YVH_BoxESP") then head.YVH_BoxESP:Destroy() end
                if head:FindFirstChild("YVH_DotESP") then head.YVH_DotESP:Destroy() end
            end
        end
    end
end

ESPButton.MouseButton1Click:Connect(function()
    espEnabled = not espEnabled
    if espEnabled then dotEspEnabled = false DotESPButton.Text = "Dot ESP" toggleColor(DotESPButton, false) end
    toggleColor(ESPButton, espEnabled)
    if not espEnabled then clearESP() end
end)

DotESPButton.MouseButton1Click:Connect(function()
    dotEspEnabled = not dotEspEnabled
    if dotEspEnabled then espEnabled = false ESPButton.Text = "ESP" toggleColor(ESPButton, false) end
    toggleColor(DotESPButton, dotEspEnabled)
    if not dotEspEnabled then clearESP() end
end)

FullbrightButton.MouseButton1Click:Connect(function()
    fullbright = not fullbright
    toggleColor(FullbrightButton, fullbright)
    if fullbright then
        Lighting.Brightness = 2
        Lighting.ClockTime = 14
        Lighting.FogEnd = 100000
        Lighting.GlobalShadows = false
        Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
    else
        Lighting.Brightness = 1
        Lighting.ClockTime = 12
        Lighting.FogEnd = 10000
        Lighting.GlobalShadows = true
        Lighting.OutdoorAmbient = Color3.fromRGB(127, 127, 127)
    end
end)

local function getSpectateTargets()
    local targets = {}
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= LocalPlayer then table.insert(targets, p) end
    end
    return targets
end

local function updateSpectatePlayer()
    spectatingPlayers = getSpectateTargets()
    if #spectatingPlayers == 0 then
        SpecName.Text = "No Players"
        currentSpectateTarget = nil
        Camera.CameraSubject = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid")
        return
    end
    if spectateIndex > #spectatingPlayers then spectateIndex = 1 end
    if spectateIndex < 1 then spectateIndex = #spectatingPlayers end
    local target = spectatingPlayers[spectateIndex]
    currentSpectateTarget = target
    SpecName.Text = target.Name
    if target.Character and target.Character:FindFirstChild("Humanoid") then
        Camera.CameraSubject = target.Character.Humanoid
    end
end

PlayerSpectateButton.MouseButton1Click:Connect(function()
    SpectateFrame.Visible = not SpectateFrame.Visible
    toggleColor(PlayerSpectateButton, SpectateFrame.Visible)
    if SpectateFrame.Visible then updateSpectatePlayer()
    else Camera.CameraSubject = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") end
end)

SpecPrev.MouseButton1Click:Connect(function() spectateIndex = spectateIndex - 1 updateSpectatePlayer() end)
SpecNext.MouseButton1Click:Connect(function() spectateIndex = spectateIndex + 1 updateSpectatePlayer() end)
SpecExit.MouseButton1Click:Connect(function() SpectateFrame.Visible = false toggleColor(PlayerSpectateButton, false) Camera.CameraSubject = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") end)

TPToolButton.MouseButton1Click:Connect(function()
    tpToolActive = not tpToolActive
    toggleColor(TPToolButton, tpToolActive)
    if tpToolActive then
        tpToolInstance = Instance.new("Tool")
        tpToolInstance.Name = "TP Tool"
        tpToolInstance.RequiresHandle = false
        tpToolInstance.Parent = LocalPlayer.Backpack
        tpToolInstance.Activated:Connect(function()
            local mouse = LocalPlayer:GetMouse()
            if mouse and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(mouse.Hit.Position + Vector3.new(0, 3, 0))
            end
        end)
    else
        if tpToolInstance then tpToolInstance:Destroy() tpToolInstance = nil end
        if LocalPlayer.Backpack:FindFirstChild("TP Tool") then LocalPlayer.Backpack["TP Tool"]:Destroy() end
        if LocalPlayer.Character:FindFirstChild("TP Tool") then LocalPlayer.Character["TP Tool"]:Destroy() end
    end
end)

SpawnButton.MouseButton1Click:Connect(function()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-1.57, 105.00, -22.51)
    end
end)

MapButton.MouseButton1Click:Connect(function()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(41.10, -78.31, -54.05)
    end
end)

FPSBoostButton.MouseButton1Click:Connect(function()
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("Decal") or v:IsA("Texture") then v:Destroy()
        elseif v:IsA("BasePart") then v.Material = Enum.Material.SmoothPlastic v.CastShadow = false v.Reflectance = 0
        elseif v:IsA("ParticleEmitter") or v:IsA("Trail") then v.Enabled = false end
    end
    Lighting.GlobalShadows = false
    Lighting.FogEnd = 9e9
    toggleColor(FPSBoostButton, true)
    wait(0.5)
    toggleColor(FPSBoostButton, false)
end)

BlueBoxButton.MouseButton1Click:Connect(function()
    toggleColor(BlueBoxButton, true)
    loadstring(game:HttpGet("https://raw.githubusercontent.com/giobolqvi1/yvh-gui/refs/heads/main/HgCH4NvG62PSy86balVH7D12ZGQZ1D6gfi9n3mYv47R5W4xjny09AX39spW4YTkO.lua.txt"))()
    wait(1)
    toggleColor(BlueBoxButton, false)
end)

WallhopButton.MouseButton1Click:Connect(function()
    toggleColor(WallhopButton, true)
    loadstring(game:HttpGet("https://raw.githubusercontent.com/giobolqvi1/wallhop-by-GioBolqv1-fuck-spiderscripts-skidders/refs/heads/main/obfuscated_script-1769006346803.lua.txt"))()
    wait(1)
    toggleColor(WallhopButton, false)
end)

UpsideDownButton.MouseButton1Click:Connect(function()
    upsideDownActive = not upsideDownActive
    toggleColor(UpsideDownButton, upsideDownActive)
end)

RunService.RenderStepped:Connect(function()
    local char = LocalPlayer.Character
    if not char then return end
    local root = char:FindFirstChild("HumanoidRootPart")
    local hum = char:FindFirstChild("Humanoid")
    
    if farming and not ritualActive and root then
        local currentTime = tick()
        local wiggle = math.sin(currentTime * 8) * 6
        root.CFrame = CFrame.new(farmTarget.X + wiggle, farmTarget.Y, farmTarget.Z)
        root.AssemblyLinearVelocity = Vector3.zero
    end
    if ritualActive and root and hum then
        root.Anchored = true
        local elapsed = tick() - ritualStartTime
        if elapsed >= 4.4 then
            hum.Health = 0
            ritualActive = false
            RitualButton.Text = "Homer Ritual"
            toggleColor(RitualButton, false)
        else
            local rampUp = math.pow(elapsed / 4.4, 4)
            local spinSpeed = 0.1 + (rampUp * 40)
            local floatSpeed = 0.05 + (rampUp * 1.5)
            root.CFrame = root.CFrame * CFrame.Angles(0, math.rad(spinSpeed), 0) + Vector3.new(0, floatSpeed, 0)
        end
    end
    if annoyServer and root and hum then
        if not annoyPlatform or not annoyPlatform.Parent then
            annoyPlatform = Instance.new("Part")
            annoyPlatform.Name = "AnnoyPlatform"
            annoyPlatform.Size = Vector3.new(10, 1, 10)
            annoyPlatform.Anchored = true
            annoyPlatform.Transparency = 1
            annoyPlatform.Parent = workspace
        end
        if tick() >= nextAnnoyTime then
            nextAnnoyTime = tick() + 2
            local players = Players:GetPlayers()
            local validTargets = {}
            for _, p in pairs(players) do
                if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                    table.insert(validTargets, p)
                end
            end
            if #validTargets > 0 then currentAnnoyTarget = validTargets[math.random(1, #validTargets)] else currentAnnoyTarget = nil end
        end
        if currentAnnoyTarget and currentAnnoyTarget.Character and currentAnnoyTarget.Character:FindFirstChild("HumanoidRootPart") then
            local targetCF = currentAnnoyTarget.Character.HumanoidRootPart.CFrame
            local myCF = targetCF * CFrame.new(0, 19, 0)
            root.CFrame = myCF
            root.AssemblyLinearVelocity = Vector3.zero
            annoyPlatform.CFrame = myCF * CFrame.new(0, -3.5, 0)
        end
        local pizza = char:FindFirstChild("Pizza") or LocalPlayer.Backpack:FindFirstChild("Pizza")
        if pizza then
            if pizza.Parent == char then pizza.Parent = LocalPlayer.Backpack else hum:EquipTool(pizza) end
        end
    end
    if pizzaSpamActive and hum then
        local pizza = char:FindFirstChild("Pizza") or LocalPlayer.Backpack:FindFirstChild("Pizza")
        if pizza then
            if pizza.Parent == char then pizza.Parent = LocalPlayer.Backpack else hum:EquipTool(pizza) end
        end
    end
    if tacoSpamActive and hum then
        local taco = char:FindFirstChild("Taco") or LocalPlayer.Backpack:FindFirstChild("Taco")
        if taco then
            if taco.Parent == char then taco.Parent = LocalPlayer.Backpack else hum:EquipTool(taco) end
        end
    end
    if upsideDownActive and root then
        local currentPos = root.Position
        local _, yRot, _ = root.CFrame:ToOrientation()
        root.CFrame = CFrame.new(currentPos) * CFrame.Angles(0, yRot, math.pi)
    end
    if platformActive and root then
        if not myPlatform or not myPlatform.Parent then
            myPlatform = Instance.new("Part")
            myPlatform.Name = "WalkPlatform"
            myPlatform.Size = Vector3.new(10, 1, 10)
            myPlatform.Anchored = true
            myPlatform.BrickColor = BrickColor.new("Dark stone grey")
            myPlatform.Material = Enum.Material.Neon
            myPlatform.Parent = workspace
        end
        myPlatform.CFrame = CFrame.new(root.Position.X, root.Position.Y - 3.5, root.Position.Z)
    elseif not platformActive and myPlatform then
        myPlatform:Destroy()
        myPlatform = nil
    end
    
    if espEnabled then
        for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("Head") then
                local color = Color3.fromRGB(255, 60, 60)
                if checkItems(plr) then color = Color3.fromRGB(255, 255, 60) end
                updateBoxESP(plr.Character, color)
            end
        end
    elseif dotEspEnabled then
        for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("Head") then
                local color = Color3.fromRGB(255, 60, 60)
                if checkItems(plr) then color = Color3.fromRGB(255, 255, 60) end
                updateDotESP(plr.Character, color)
            end
        end
    end
end)

LocalPlayer.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

task.spawn(function()
    while true do
        task.wait(600)
        VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.RightControl, false, game)
        task.wait(0.1)
        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.RightControl, false, game)
    end
end)

task.spawn(function()
    while true do
        task.wait(300)
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
    end
end)
